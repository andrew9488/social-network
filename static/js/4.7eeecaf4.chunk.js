(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[4],{307:function(e,t,a){e.exports={dialogs:"Dialogs_dialogs__FhxYh"}},308:function(e,t,a){e.exports={dialog:"Dialog_dialog__vfZZh",dialogItemContainer:"Dialog_dialogItemContainer__3oAht",activeLink:"Dialog_activeLink__3wrI0",dialogItem:"Dialog_dialogItem__3A0vj"}},309:function(e,t,a){e.exports={message:"Message_message__NMOAK",messageText:"Message_messageText__215RR",sendMessageButton:"Message_sendMessageButton__2mVJZ"}},310:function(e,t,a){e.exports={chatContainer:"Chat_chatContainer__1trV7",chatBlock:"Chat_chatBlock__1bCO1"}},323:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(1),c=a.n(s),i=a(307),o=a.n(i),r=a(308),l=a.n(r),d=a(12),j=a(14),u=a(113),b=c.a.memo((function(e){return Object(n.jsxs)("div",{className:l.a.dialog,children:[e.dialogs.map((function(e){return Object(n.jsx)("div",{className:l.a.dialogItemContainer,children:Object(n.jsx)(d.b,{to:"".concat(j.a.DIALOGS,"/").concat(e.id),activeClassName:l.a.activeLink,children:Object(n.jsxs)("div",{className:l.a.dialogItem,children:[Object(n.jsx)("img",{src:e.img,alt:"avatar"}),Object(n.jsx)("span",{children:e.name})]})})},e.id)})),Object(n.jsx)("div",{className:l.a.dialogItemContainer,children:Object(n.jsx)(d.b,{to:"".concat(j.a.DIALOGS).concat(j.a.CHAT),activeClassName:l.a.activeLink,children:Object(n.jsxs)("div",{className:l.a.dialogItem,children:[Object(n.jsx)("img",{src:u.a,alt:"city-Z"}),Object(n.jsx)("span",{children:"Polesye National Republic"})]})})})]})})),m=a(11),O=a(111),v=a(9),g=Object(v.d)(Object(m.b)((function(e){return{dialogs:e.dialogsPage.dialogs}}),{}),O.a)(b),f=a(309),x=a.n(f),h=a(112),_=a(28),p=c.a.memo((function(e){var t=Object(m.c)(),a=Object(s.useCallback)((function(a){e.sendMessage(a.newText),t(Object(_.a)("formForSendNewText"))}),[e]);return Object(n.jsxs)("div",{className:x.a.message,children:[Object(n.jsx)("div",{className:x.a.messageText,children:e.messages.map((function(e){return Object(n.jsx)("div",{children:e.message},e.id)}))}),Object(n.jsx)(h.a,{onSubmit:a})]})})),N=a(143),C=Object(v.d)(Object(m.b)((function(e){return{messages:e.dialogsPage.messages}}),(function(e){return{sendMessage:function(t){e(Object(N.b)(t))}}})),O.a)(p),I=a(10),L=a(45),k=a(59),w=a(310),S=a.n(w),E=c.a.memo((function(){var e=Object(s.useState)(null),t=Object(k.a)(e,2),a=t[0],c=t[1],i=Object(s.useState)([]),o=Object(k.a)(i,2),r=o[0],l=o[1],d=Object(s.useState)("pending"),j=Object(k.a)(d,2),u=j[0],b=j[1],O=Object(s.useRef)(null),v=Object(m.c)();Object(s.useEffect)((function(){var e,t=function(){setTimeout(a,3e3)};function a(){var a,n;null===(a=e)||void 0===a||a.removeEventListener("close",t),null===(n=e)||void 0===n||n.close(),(e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx")).addEventListener("close",t),c(e)}return a(),function(){e.removeEventListener("close",t),e.close()}}),[]),Object(s.useEffect)((function(){var e=function(e){var t=JSON.parse(e.data);l((function(e){return[].concat(Object(L.a)(e),Object(L.a)(t))}))};return null===a||void 0===a||a.addEventListener("message",e),function(){null===a||void 0===a||a.removeEventListener("message",e)}}),[a]),Object(s.useEffect)((function(){var e=function(){b("ready")};return null===a||void 0===a||a.addEventListener("open",e),function(){null===a||void 0===a||a.removeEventListener("open",e)}}),[a]);var g=Object(s.useCallback)((function(e){null===a||void 0===a||a.send(e.newText),v(Object(_.a)("formForSendNewText"))}),[a]);return Object(s.useEffect)((function(){var e;null===(e=O.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[r]),Object(n.jsxs)("div",{className:S.a.chatContainer,children:[Object(n.jsxs)("div",{className:S.a.chatBlock,children:[r.map((function(e,t){return Object(n.jsx)(T,{message:e},t+e.userId)})),Object(n.jsx)("div",{ref:O})]}),Object(n.jsx)(h.a,{disable:null===a||"ready"!==u,onSubmit:g})]})})),T=function(e){var t=e.message;return Object(n.jsxs)("div",{children:[Object(n.jsx)("img",{src:t.photo,alt:"userPhoto",style:{width:"30px"}})," ",Object(n.jsx)("b",{children:t.userName}),Object(n.jsx)("br",{}),t.message,Object(n.jsx)("hr",{})]})},A=c.a.memo((function(){var e=Object(I.g)();return Object(n.jsxs)("div",{className:o.a.dialogs,children:[Object(n.jsx)("div",{children:Object(n.jsx)(g,{})}),e.location.pathname==="".concat(j.a.DIALOGS).concat(j.a.CHAT)?Object(n.jsx)(E,{}):Object(n.jsx)(C,{})]})}));t.default=A}}]);
//# sourceMappingURL=4.7eeecaf4.chunk.js.map